import{show,customProperty,detectAnimation,ClassName}from"./util";import{buildClickStepLinearListener,buildClickStepNonLinearListener}from"./listeners";const DEFAULT_OPTIONS={linear:!0,animation:!1,selectors:{steps:".step",trigger:".step-trigger",stepper:".bs-stepper"}};class Stepper{constructor(t,e={}){this._element=t,this._currentIndex=0,this._stepsContents=[],this.options={...DEFAULT_OPTIONS,...e},this.options.selectors={...DEFAULT_OPTIONS.selectors,...this.options.selectors},this.options.linear&&this._element.classList.add(ClassName.LINEAR),this._steps=[].slice.call(this._element.querySelectorAll(this.options.selectors.steps)),this._steps.filter((t=>t.hasAttribute("data-target"))).forEach((t=>{this._stepsContents.push(this._element.querySelector(t.getAttribute("data-target")))})),detectAnimation(this._stepsContents,this.options),this._setLinkListeners(),Object.defineProperty(this._element,customProperty,{value:this,writable:!0}),this._steps.length&&show(this._element,this._currentIndex,this.options,(()=>{}))}_setLinkListeners(){this._steps.forEach((t=>{const e=t.querySelector(this.options.selectors.trigger);this.options.linear?(this._clickStepLinearListener=buildClickStepLinearListener(this.options),e.addEventListener("click",this._clickStepLinearListener)):(this._clickStepNonLinearListener=buildClickStepNonLinearListener(this.options),e.addEventListener("click",this._clickStepNonLinearListener))}))}next(){const t=this._currentIndex+1<=this._steps.length-1?this._currentIndex+1:this._steps.length-1;show(this._element,t,this.options,(()=>{this._currentIndex=t}))}previous(){const t=this._currentIndex-1>=0?this._currentIndex-1:0;show(this._element,t,this.options,(()=>{this._currentIndex=t}))}to(t){const e=t-1,s=e>=0&&e<this._steps.length?e:0;show(this._element,s,this.options,(()=>{this._currentIndex=s}))}reset(){show(this._element,0,this.options,(()=>{this._currentIndex=0}))}destroy(){this._steps.forEach((t=>{const e=t.querySelector(this.options.selectors.trigger);this.options.linear?e.removeEventListener("click",this._clickStepLinearListener):e.removeEventListener("click",this._clickStepNonLinearListener)})),this._element[customProperty]=void 0,this._element=void 0,this._currentIndex=void 0,this._steps=void 0,this._stepsContents=void 0,this._clickStepLinearListener=void 0,this._clickStepNonLinearListener=void 0}}export default Stepper;