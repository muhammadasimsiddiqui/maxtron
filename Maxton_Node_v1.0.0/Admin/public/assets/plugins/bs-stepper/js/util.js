import{WinEvent,createCustomEvent}from"./polyfill";const MILLISECONDS_MULTIPLIER=1e3,ClassName={ACTIVE:"active",LINEAR:"linear",BLOCK:"dstepper-block",NONE:"dstepper-none",FADE:"fade",VERTICAL:"vertical"},transitionEndEvent="transitionend",customProperty="bsStepper",show=(s,e,t,a)=>{const n=s.bsStepper;if(n._steps[e].classList.contains(ClassName.ACTIVE)||n._stepsContents[e].classList.contains(ClassName.ACTIVE))return;const i=createCustomEvent("show.bs-stepper",{cancelable:!0,detail:{from:n._currentIndex,to:e,indexStep:e}});s.dispatchEvent(i);const o=n._steps.filter((s=>s.classList.contains(ClassName.ACTIVE))),r=n._stepsContents.filter((s=>s.classList.contains(ClassName.ACTIVE)));i.defaultPrevented||(o.length&&o[0].classList.remove(ClassName.ACTIVE),r.length&&(r[0].classList.remove(ClassName.ACTIVE),s.classList.contains(ClassName.VERTICAL)||n.options.animation||r[0].classList.remove(ClassName.BLOCK)),showStep(s,n._steps[e],n._steps,t),showContent(s,n._stepsContents[e],n._stepsContents,r,a))},showStep=(s,e,t,a)=>{t.forEach((e=>{const t=e.querySelector(a.selectors.trigger);t.setAttribute("aria-selected","false"),s.classList.contains(ClassName.LINEAR)&&t.setAttribute("disabled","disabled")})),e.classList.add(ClassName.ACTIVE);const n=e.querySelector(a.selectors.trigger);n.setAttribute("aria-selected","true"),s.classList.contains(ClassName.LINEAR)&&n.removeAttribute("disabled")},showContent=(s,e,t,a,n)=>{const i=s.bsStepper,o=t.indexOf(e),r=createCustomEvent("shown.bs-stepper",{cancelable:!0,detail:{from:i._currentIndex,to:o,indexStep:o}});if(e.classList.contains(ClassName.FADE)){e.classList.remove(ClassName.NONE);const t=getTransitionDurationFromElement(e);e.addEventListener("transitionend",(function t(){e.classList.add(ClassName.BLOCK),e.removeEventListener("transitionend",t),s.dispatchEvent(r),n()})),a.length&&a[0].classList.add(ClassName.NONE),e.classList.add(ClassName.ACTIVE),emulateTransitionEnd(e,t)}else e.classList.add(ClassName.ACTIVE),e.classList.add(ClassName.BLOCK),s.dispatchEvent(r),n()},getTransitionDurationFromElement=s=>{if(!s)return 0;let e=window.getComputedStyle(s).transitionDuration;return parseFloat(e)?(e=e.split(",")[0],1e3*parseFloat(e)):0},emulateTransitionEnd=(s,e)=>{let t=!1;const a=e+5;function n(){t=!0,s.removeEventListener("transitionend",n)}s.addEventListener("transitionend",n),window.setTimeout((()=>{t||s.dispatchEvent(WinEvent("transitionend")),s.removeEventListener("transitionend",n)}),a)},detectAnimation=(s,e)=>{e.animation&&s.forEach((s=>{s.classList.add(ClassName.FADE),s.classList.add(ClassName.NONE)}))};export{show,ClassName,customProperty,detectAnimation};